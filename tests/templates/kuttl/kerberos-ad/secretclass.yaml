# must be applied by a command step, since the reference namespace depends on the (random) test namespace
---
apiVersion: secrets.stackable.tech/v1alpha1
kind: SecretClass
metadata:
  name: kuttl-secret-operator-kerberos-ad-kerberos
spec:
  backend:
    kerberosKeytab:
      realmName: SBLE.TEST
      kdc: sble-adds1.sble.test
      admin:
        activeDirectory:
          # ldapServer must match the AD Domain Controller's FQDN or GSSAPI authn will fail
          # You may need to set AD as your fallback DNS resolver in your Kube DNS Corefile
          ldapServer: sble-adds1.sble.test
          passwordCacheSecret:
            # namespace: default
            name: secret-operator-ad-passwords
          # Subfolder must be created manually, of type "msDS-ShadowPrincipalContainer"
          userDistinguishedName: CN=Stackable,CN=Users,DC=sble,DC=test
          schemaDistinguishedName: CN=Schema,CN=Configuration,DC=sble,DC=test
      adminKeytabSecret:
        # Create by running "ktpass /princ stackable-secret-operator@SBLE.TEST /out secret-op.kt +rndPass /ptype KRB5_NT_PRINCIPAL /mapuser stackable-secret-operator@SBLE.TEST /crypto AES256-SHA1"
        # namespace: default
        name: secret-operator-keytab
      adminPrincipal: stackable-secret-operator
