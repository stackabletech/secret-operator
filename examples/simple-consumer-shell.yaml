# Shell container that injects an arbitrary user-declared secret
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: secret-consumer-shell
spec:
  replicas: 1
  selector:
    matchLabels:
      app: secret-consumer-shell
  template:
    metadata:
      labels:
        app: secret-consumer-shell
    spec:
      containers:
      - name: shell
        image: archlinux
        stdin: true
        tty: true
        volumeMounts:
        - name: secret
          mountPath: /secret
      terminationGracePeriodSeconds: 1
      volumes:
      - name: secret
        csi:
          driver: secrets.stackable.tech
          volumeAttributes:
            secrets.stackable.tech/class: secret
            secrets.stackable.tech/scope: node
---
apiVersion: v1
kind: Secret
metadata:
  name: secret-consumer-shell-secret
  labels:
    secrets.stackable.tech/class: secret
    secrets.stackable.tech/node: kind-control-plane
    type: custom-secret
stringData:
  boo: spooky, indeed!
